### 1. 子查询
子查询（subquery）：嵌套在其他查询中的查询。

##### 1.1 使用子查询
1. 列出订购物品TNT2的所有客户，一般查询步骤如下：
- 在orderitems中检索物prod_id='TNT2'的订单编号order_num
`SELECT order_num FROM orderitems WHERE prod_id='TNT2'`=>(20005,20007)
- 在orders中检索订单编号order_num在上一步检索结果中的客户编号cust_id
`SELECT cust_id FROM orders WHERE order_num IN (20005,20007);`=>(10001,10004)
- 在customers中检索客户id在上一步检索结果中的需要客户信息。
`SELECT cust_id,cust_name FROM customers WHERE cust_id IN (10001,10004);`

2. 上述过程的子查询语句：
```mysql
mysql> SELECT cust_id,cust_name FROM customers WHERE cust_id IN (
    -> SELECT cust_id FROM orders WHERE order_num IN (
    -> SELECT order_num FROM orderitems WHERE prod_id='TNT2'
    -> )
    -> );
+---------+----------------+
| cust_id | cust_name      |
+---------+----------------+
|   10001 | Coyote Inc.    |
|   10004 | Yosemite Place |
+---------+----------------+
```

3. 注意
子查询对嵌套语句数量没有限制，但考虑性能不能嵌套太多。

##### 1.2 子查询创建计算字段
1. 根据customers表中的cust_id，计算orders中每一位客户的订单数。
```mysql
mysql> SELECT customers.cust_id,cust_name,(
    -> SELECT Count(*) FROM orders WHERE orders.cust_id=customers.cust_id
    -> ) AS o_num FROM customers;
+---------+----------------+-------+
| cust_id | cust_name      | o_num |
+---------+----------------+-------+
|   10001 | Coyote Inc.    |     2 |
|   10002 | Mouse House    |     0 |
|   10003 | Wascals        |     1 |
+---------+----------------+-------+
```